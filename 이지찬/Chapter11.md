# Chapter 11 - 이벤트 기반 아키텍처: 이벤트를 사용한 마이크로서비스 통합

## 11.1 분산된 진흙 공, 명사로 생각하기
* **시스템을 명사를 기준으로 분리**
* **그 하위에는 행동을 구현**
* **이를 시스템화 하면 각각의 API가 된다.**
* **정상경로(문제없는)의 시나리오라면 의존성에 맞게 순차적으로 처리가 잘될것이다.**
* **헌데 의존성이 하위에 있는 창고에서 어떤 문제가 발생해서 데이터를 갱신을 해야 하는데 이는 의존성을 역으로 쫓게 되므로 지저분해진다 라고 표현하는것 같다.**


## 분산 진흙공 안티패턴
* **마이크로 서비스로 나뉘어져 있지만 실제로는 강하게 결합되어 있는 상태**
* **시간적 결합도가 높은 상태**
* **각각의 서비스가 독립적으로 작동 할 수 있도록 이벤트 메시지를 통해 이를 해소한다**
  * **요청에 의한 응답은 빠르게 전달하고 실제 서비스 동작 결과에 대해서는 이후에 알림**
* **무조건 순차적으로 처리 되야하는 시스템이 아닌 각 기능이 독립적으로 작동해도 문제가 없는 케이스의 경우에만 가능하다.**


## 시간적 결합도
* **서비스들이 특정 순서에 맞춰 동기적으로 실행되어야 하는 의존성**
* **예를들어 주문이 들어 왔을때 주문 생성 -> 재고 차감 -> 결제 이 작업이 앞쪽의 작업이 끝나야만 진행된다.**

## 공간적 결합도
* **서비스들을 직접적인 참조, 호출을 통해 연결되어 있는 의존성**


### 개념적인 부분도 부분이지만 구현 및 어떻게 동작 될지 왜 이렇게 쓰여야 하는지 등등을 잘 이해를 해야함
* **특히나 카프카, rabbitmq, redis 등 어떤상황에서 어떤걸 써야하는지 상황과 근거에 맞게 적용해야 이후에 비용이 줄어들것이기 때문**

## 11.2 분산 시스템에서 오류 처리하기
* **순차적으로 처리 되어야 하는 작업에서 하나의 실패로 인해 연쇄적으로 일어나는 실패를 "시간적 결합" 이라고 부른다.**
* **시스템이 커질수록 실패할 확률이 점점 올라간다.**
* **서비스들이 특정 순서와 타이밍에 맞춰서 동작(동기적인 작동)**

## 11.3 대안: 비동기 메시징을 사용한 시간적 결합
* **명사가 아닌 동사로 생각**
* **정적인 명사보다는 객체의 행위를 중심으로 사고 그렇게 하면 시스템이 어떤 일을 하는지 유추하기가 쉬워진다.**


## 11.7 마치며
* **마이크로 서비스는 각 서비스를 분리 개별 관리 하기 때문에 새로운 서비스 추가, 변경시 용이하다.**
* **다만, 전체적인 시스템의 흐름을 파악하는데는 많은 어려움을 겪을 수 있다.**
* **서비스가 분산 되어 있고 각 서비스는 어떤 서비스를 의존하는지, 어떤 환경으로 구성 되어 있는지, 동기방식인지 비동기 방식인지 등등**
* **여러가지 복합적인 요소들이 개별적으로 떨어져 있기 때문에 이를 한번에 파악하기는 어렵다.**
* **그래서 이를 잘 추적하기 위한 모니터링 시스템을 같이 잘 구축 해야하는 단점이 있다.**
    * * **추가적으로 문서화도 잘 해놓아야 함**
